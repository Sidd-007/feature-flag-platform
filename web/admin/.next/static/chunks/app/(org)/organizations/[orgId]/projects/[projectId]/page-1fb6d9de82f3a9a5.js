(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[653],{5325:function(e,s,t){Promise.resolve().then(t.bind(t,9107))},9107:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return F}});var n=t(7437),a=t(3089),r=t(1472),i=t(2021),l=t(6582),c=t(932),o=t(4606),d=t(8110),m=t(2265),x=t(1865),u=t(9482);let h=u.Ry({name:u.Z_().min(1,"Environment name is required").max(100,"Name must be 100 characters or less"),key:u.Z_().min(1,"Environment key is required").max(50,"Key must be 50 characters or less").regex(/^[a-z0-9-_]+$/,"Key can only contain lowercase letters, numbers, hyphens, and underscores"),description:u.Z_().max(500,"Description must be 500 characters or less").optional(),enabled:u.O7()});function p(e){let{open:s,onOpenChange:t,onSubmit:u}=e,p=(0,x.cI)({resolver:(0,d.F)(h),defaultValues:{name:"",key:"",description:"",enabled:!0}}),j=p.watch("name");(0,m.useEffect)(()=>{if(j&&!p.formState.dirtyFields.key){let e=j.toLowerCase().replace(/[^a-z0-9\s-_]/g,"").replace(/\s+/g,"_").replace(/[-_]+/g,"_").replace(/^[-_]|[-_]$/g,"");p.setValue("key",e,{shouldValidate:!0})}},[j,p]);let g=async e=>{try{await u(e),p.reset(),t(!1)}catch(e){}},f=()=>{p.reset(),t(!1)};return(0,n.jsx)(r.Vq,{open:s,onOpenChange:f,children:(0,n.jsxs)(r.cZ,{className:"sm:max-w-md",children:[(0,n.jsxs)(r.fK,{children:[(0,n.jsx)(r.$N,{children:"Create Environment"}),(0,n.jsx)(r.Be,{children:"Create a new environment to manage feature flags for different stages of your application."})]}),(0,n.jsx)(i.l0,{...p,children:(0,n.jsxs)("form",{onSubmit:p.handleSubmit(g),className:"space-y-4",children:[(0,n.jsx)(i.Wi,{control:p.control,name:"name",render:e=>{let{field:s}=e;return(0,n.jsxs)(i.xJ,{children:[(0,n.jsx)(i.lX,{children:"Environment Name *"}),(0,n.jsx)(i.NI,{children:(0,n.jsx)(l.I,{placeholder:"Production",...s,className:"h-9"})}),(0,n.jsx)(i.zG,{})]})}}),(0,n.jsx)(i.Wi,{control:p.control,name:"key",render:e=>{let{field:s}=e;return(0,n.jsxs)(i.xJ,{children:[(0,n.jsx)(i.lX,{children:"Environment Key *"}),(0,n.jsx)(i.NI,{children:(0,n.jsx)(l.I,{placeholder:"production",...s,className:"h-9 font-mono text-sm"})}),(0,n.jsx)(i.zG,{}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:"Used in SDKs and API calls. Auto-generated from name but can be edited."})]})}}),(0,n.jsx)(i.Wi,{control:p.control,name:"description",render:e=>{let{field:s}=e;return(0,n.jsxs)(i.xJ,{children:[(0,n.jsx)(i.lX,{children:"Description"}),(0,n.jsx)(i.NI,{children:(0,n.jsx)(o.g,{placeholder:"Optional description of your environment...",...s,className:"min-h-[80px] resize-none"})}),(0,n.jsx)(i.zG,{})]})}}),(0,n.jsx)(i.Wi,{control:p.control,name:"enabled",render:e=>{let{field:s}=e;return(0,n.jsxs)(i.xJ,{className:"flex items-center justify-between rounded-lg border p-4",children:[(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)(i.lX,{className:"text-base",children:"Enabled"}),(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Environment is active and can serve flags"})]}),(0,n.jsx)(i.NI,{children:(0,n.jsx)(c.r,{checked:s.value,onCheckedChange:s.onChange})})]})}}),(0,n.jsxs)(r.cN,{children:[(0,n.jsx)(a.z,{type:"button",variant:"outline",onClick:f,children:"Cancel"}),(0,n.jsx)(a.z,{type:"submit",disabled:p.formState.isSubmitting||!p.formState.isValid,children:p.formState.isSubmitting?"Creating...":"Create Environment"})]})]})})]})})}var j=t(1785),g=t(609),f=t(9346),v=t(150),N=t(7472),b=t(3505),y=t(9617),w=t(5367);function k(e){let{environment:s,projectId:t,onOpenFlags:r,onToggleEnabled:i,onEdit:l,onDelete:o}=e,[d,x]=(0,m.useState)(!1),[u,h]=(0,m.useState)(!1),p=async()=>{h(!0);try{await i(s)}finally{h(!1)}};return(0,n.jsxs)(g.Zb,{className:"group hover:shadow-md transition-all duration-200 hover:border-primary/20 cursor-pointer rounded-2xl border",onClick:()=>r(s),onContextMenu:e=>{e.preventDefault(),x(!0)},children:[(0,n.jsx)(g.Ol,{className:"pb-3",children:(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)("h3",{className:"font-semibold text-lg truncate",children:s.name}),(0,n.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(!1!==s.enabled?"bg-green-500":"bg-gray-400")}),s.isDefault&&(0,n.jsx)(v.C,{variant:"secondary",className:"text-xs",children:"Default"})]}),s.description&&(0,n.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:s.description}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("code",{className:"text-xs bg-muted px-2 py-1 rounded font-mono",children:s.key}),(0,n.jsx)(j.qi,{text:s.key})]})]}),(0,n.jsxs)(f.h_,{open:d,onOpenChange:x,children:[(0,n.jsx)(f.$F,{asChild:!0,children:(0,n.jsx)(a.z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:e=>{e.stopPropagation(),x(!0)},children:(0,n.jsx)(N.Z,{className:"h-4 w-4"})})}),(0,n.jsxs)(f.AW,{align:"end",children:[(0,n.jsxs)(f.Xi,{onClick:e=>{e.stopPropagation(),r(s)},className:"gap-2",children:[(0,n.jsx)(b.Z,{className:"h-4 w-4"}),"Open Flags"]}),(0,n.jsxs)(f.Xi,{onClick:e=>{e.stopPropagation(),l(s)},className:"gap-2",children:[(0,n.jsx)(y.Z,{className:"h-4 w-4"}),"Edit"]}),(0,n.jsxs)(f.Xi,{onClick:e=>{e.stopPropagation(),o(s)},className:"gap-2 text-destructive focus:text-destructive",children:[(0,n.jsx)(w.Z,{className:"h-4 w-4"}),"Delete"]})]})]})]})}),(0,n.jsx)(g.aY,{className:"pb-3",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm text-muted-foreground",children:"Enabled"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(c.r,{checked:!1!==s.enabled,onCheckedChange:p,disabled:u,onClick:e=>e.stopPropagation()}),(0,n.jsx)("span",{className:"text-sm font-medium",children:!1!==s.enabled?"ON":"OFF"})]})]})}),(0,n.jsx)(g.eW,{className:"pt-0",children:(0,n.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,n.jsxs)(v.C,{variant:"secondary",className:"text-xs",children:["Updated ",new Date(s.updated_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),(0,n.jsxs)(a.z,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity gap-2",onClick:e=>{e.stopPropagation(),r(s)},children:[(0,n.jsx)(b.Z,{className:"h-4 w-4"}),"Open Flags"]})]})})]})}var C=t(5309),E=t(8692),S=t(573),O=t(6454),Z=t(1291),_=t(9883),z=t(6714),P=t(4033);function F(){let e=(0,P.useParams)(),s=e.orgId,t=e.projectId,{toast:r}=(0,E.pm)(),i=(0,S.c)(),[l,c]=(0,m.useState)(null),[o,d]=(0,m.useState)([]),[x,u]=(0,m.useState)(!0),[h,g]=(0,m.useState)(!1),f=(0,m.useCallback)(async()=>{try{let e=await O.Z.getProject(s,t);e.error?r({title:"Error loading project",description:e.error,variant:"destructive"}):c(e.data)}catch(e){r({title:"Failed to load project",description:"An unexpected error occurred",variant:"destructive"})}},[s,t,r]),N=(0,m.useCallback)(async()=>{try{let e=await O.Z.getEnvironments(s,t);if(e.error)r({title:"Error loading environments",description:e.error,variant:"destructive"});else{let s=e.data;if(s&&"object"==typeof s&&!Array.isArray(s)){let e=s;s=e.data||e.environments||e.items||s}let t=Array.isArray(s)?s:[];d(t)}}catch(e){r({title:"Failed to load environments",description:"An unexpected error occurred",variant:"destructive"})}},[s,t,r]);(0,m.useEffect)(()=>{let e=async()=>{u(!0),await Promise.all([f(),N()]),u(!1)};e()},[f,N]);let b=async e=>{try{let n=await O.Z.createEnvironment(s,t,e);n.error?r({title:"Failed to create environment",description:n.error,variant:"destructive"}):(r({title:"Success",description:'Environment "'.concat(e.name,'" created successfully.')}),await N(),i.navigateToFlags(t,e.key))}catch(e){r({title:"Failed to create environment",description:"An unexpected error occurred",variant:"destructive"})}},y=async e=>{r({title:"Coming soon",description:"Environment toggle will be implemented soon."})};return x?(0,n.jsxs)("div",{className:"p-8",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)(C.O,{className:"h-6 w-32 mb-4"}),(0,n.jsx)(C.O,{className:"h-8 w-64 mb-2"}),(0,n.jsx)(C.O,{className:"h-4 w-96"})]}),(0,n.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:4}).map((e,s)=>(0,n.jsx)(C.O,{className:"h-40 rounded-2xl"},s))})]}):l?(0,n.jsxs)("div",{className:"p-8",children:[(0,n.jsxs)("nav",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-6",children:[(0,n.jsxs)(a.z,{variant:"ghost",size:"sm",onClick:()=>i.navigateToOrgHome(),className:"gap-2 text-muted-foreground hover:text-foreground",children:[(0,n.jsx)(Z.Z,{className:"h-4 w-4"}),"Projects"]}),(0,n.jsx)("span",{children:"/"}),(0,n.jsx)("span",{className:"text-foreground font-medium",children:l.name})]}),(0,n.jsx)("div",{className:"mb-8",children:(0,n.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-2",children:l.name}),l.description&&(0,n.jsx)("p",{className:"text-muted-foreground mb-4",children:l.description}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(v.C,{variant:"outline",className:"font-mono",children:l.key}),(0,n.jsx)(j.qi,{text:l.key})]})]}),(0,n.jsxs)(a.z,{onClick:()=>g(!0),className:"gap-2",children:[(0,n.jsx)(_.Z,{className:"h-4 w-4"}),"New Environment"]})]})}),0===o.length?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-16",children:[(0,n.jsx)("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-4",children:(0,n.jsx)(z.Z,{className:"h-8 w-8 text-muted-foreground"})}),(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Create your first environment"}),(0,n.jsx)("p",{className:"text-muted-foreground mb-6 text-center max-w-md",children:"Environments help you manage different stages of your application like development, staging, and production. Start by creating your first environment."}),(0,n.jsxs)(a.z,{onClick:()=>g(!0),className:"gap-2",children:[(0,n.jsx)(_.Z,{className:"h-4 w-4"}),"Create Environment"]})]}):(0,n.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:o.map(e=>(0,n.jsx)(k,{environment:e,projectId:t,onOpenFlags:e=>i.navigateToFlags(t,e.key),onToggleEnabled:y,onEdit:()=>{r({title:"Coming soon",description:"Environment editing will be implemented soon."})},onDelete:()=>{r({title:"Coming soon",description:"Environment deletion will be implemented soon."})}},e.id))}),(0,n.jsx)(p,{open:h,onOpenChange:g,onSubmit:b})]}):(0,n.jsx)("div",{className:"p-8",children:(0,n.jsxs)("div",{className:"text-center py-16",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Project not found"}),(0,n.jsx)("p",{className:"text-muted-foreground mb-4",children:"The project you're looking for doesn't exist or you don't have access to it."}),(0,n.jsxs)(a.z,{onClick:()=>i.navigateToOrgHome(),children:[(0,n.jsx)(Z.Z,{className:"h-4 w-4 mr-2"}),"Back to Projects"]})]})})}},932:function(e,s,t){"use strict";t.d(s,{r:function(){return l}});var n=t(7437),a=t(2265),r=t(2376),i=t(345);let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)(r.fC,{className:(0,i.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:s,children:(0,n.jsx)(r.bU,{className:(0,i.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});l.displayName=r.fC.displayName}},function(e){e.O(0,[461,968,64,996,243,266,938,707,971,472,744],function(){return e(e.s=5325)}),_N_E=e.O()}]);