# Feature Flag & Experimentation Platform Environment Configuration
# Copy this file to .env and update the values for your environment

# =================================================================
# ENVIRONMENT SETTINGS
# =================================================================
ENV=development
FF_SERVER_ENVIRONMENT=development

# =================================================================
# SERVER CONFIGURATION
# =================================================================
# Control Plane API
FF_SERVER_HOST=0.0.0.0
FF_SERVER_PORT=8080
FF_SERVER_READ_TIMEOUT=30s
FF_SERVER_WRITE_TIMEOUT=30s
FF_SERVER_SHUTDOWN_TIMEOUT=30s

# Edge Evaluator (different port)
# FF_SERVER_PORT=8081

# Event Ingestor (different port)  
# FF_SERVER_PORT=8082

# Analytics Engine (different port)
# FF_SERVER_PORT=8083

# =================================================================
# DATABASE CONFIGURATION
# =================================================================
# PostgreSQL (Control Plane)
FF_DATABASE_HOST=localhost
FF_DATABASE_PORT=5432
FF_DATABASE_DATABASE=feature_flags
FF_DATABASE_USERNAME=postgres
FF_DATABASE_PASSWORD=password
FF_DATABASE_SSL_MODE=disable
FF_DATABASE_MAX_OPEN_CONNS=25
FF_DATABASE_MAX_IDLE_CONNS=5
FF_DATABASE_MAX_LIFETIME=5m

# ClickHouse (Analytics)
FF_CLICKHOUSE_HOST=localhost
FF_CLICKHOUSE_PORT=9000
FF_CLICKHOUSE_DATABASE=analytics
FF_CLICKHOUSE_USERNAME=default
FF_CLICKHOUSE_PASSWORD=

# =================================================================
# CACHE CONFIGURATION
# =================================================================
# Redis
FF_REDIS_HOST=localhost
FF_REDIS_PORT=6379
FF_REDIS_PASSWORD=
FF_REDIS_DATABASE=0
FF_REDIS_POOL_SIZE=10
FF_REDIS_DIAL_TIMEOUT=5s
FF_REDIS_READ_TIMEOUT=3s
FF_REDIS_WRITE_TIMEOUT=3s

# =================================================================
# MESSAGE BROKER CONFIGURATION
# =================================================================
# NATS JetStream
FF_NATS_URL=nats://localhost:4222
FF_NATS_MAX_RECONNECT=10
FF_NATS_RECONNECT_WAIT=2s
FF_NATS_TIMEOUT=5s
FF_NATS_JETSTREAM_DOMAIN=

# =================================================================
# AUTHENTICATION & SECURITY
# =================================================================
# JWT Configuration
FF_AUTH_JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
FF_AUTH_JWT_EXPIRY=24h
FF_AUTH_BCRYPT_COST=12

# OIDC Configuration (optional)
FF_AUTH_OIDC_ISSUER=
FF_AUTH_OIDC_CLIENT_ID=
FF_AUTH_OIDC_CLIENT_SECRET=

# =================================================================
# FEATURE FLAG CONFIGURATION
# =================================================================
FF_FEATURE_FLAGS_CONFIG_CACHE_TTL=5m
FF_FEATURE_FLAGS_CONFIG_REFRESH_INTERVAL=30s
FF_FEATURE_FLAGS_EVALUATION_TIMEOUT=100ms
FF_FEATURE_FLAGS_MAX_RULES_PER_FLAG=50
FF_FEATURE_FLAGS_MAX_SEGMENTS_PER_ENV=100

# =================================================================
# OBSERVABILITY CONFIGURATION
# =================================================================
# Metrics (Prometheus)
FF_OBSERVABILITY_METRICS_ENABLED=true
FF_OBSERVABILITY_METRICS_PATH=/metrics
FF_OBSERVABILITY_METRICS_PORT=9090

# Tracing (OpenTelemetry)
FF_OBSERVABILITY_TRACING_ENABLED=false
FF_OBSERVABILITY_TRACING_SERVICE_NAME=feature-flag-platform
FF_OBSERVABILITY_TRACING_ENDPOINT=http://localhost:14268/api/traces
FF_OBSERVABILITY_TRACING_SAMPLE_RATE=0.1

# Logging
FF_OBSERVABILITY_LOGGING_LEVEL=info
FF_OBSERVABILITY_LOGGING_FORMAT=json
FF_OBSERVABILITY_LOGGING_OUTPUT=stdout
FF_OBSERVABILITY_LOGGING_STRUCTURED=true

# =================================================================
# DEVELOPMENT SETTINGS
# =================================================================
# Admin UI (Next.js)
NEXT_PUBLIC_API_URL=http://localhost:8080
NODE_ENV=development

# Database URLs for migrations
DATABASE_URL=postgres://postgres:password@localhost:5432/feature_flags?sslmode=disable
CLICKHOUSE_URL=clickhouse://localhost:9000/analytics

# =================================================================
# PRODUCTION SETTINGS (uncomment and configure for production)
# =================================================================
# ENV=production
# FF_DATABASE_SSL_MODE=require
# FF_AUTH_JWT_SECRET=your-production-secret-from-secrets-manager
# FF_OBSERVABILITY_TRACING_ENABLED=true
# FF_OBSERVABILITY_LOGGING_LEVEL=warn

# =================================================================
# DOCKER COMPOSE OVERRIDES
# =================================================================
# These are used by docker-compose.yml
COMPOSE_PROJECT_NAME=feature-flags
POSTGRES_DB=feature_flags
POSTGRES_USER=postgres
POSTGRES_PASSWORD=password
CLICKHOUSE_DB=analytics
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

FF_CONTROL_PLANE_URL=http://localhost:8080
FF_EDGE_EVALUATOR_API_KEY=ff_df394ac83d67da87b2bc12175990e4f9a38b02bded0b98a280b319f8dbfee5a3
